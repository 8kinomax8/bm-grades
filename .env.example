# Environment Variables Configuration

## Backend (.env file to create on EC2)

```bash
# Node environment
NODE_ENV=production
PORT=3001
HOST=0.0.0.0

# Frontend URL (for CORS) - Replace with your Amplify domain or EC2 IP
FRONTEND_URL=http://ec2-54-224-32-168.compute-1.amazonaws.com

# AWS RDS Database
RDS_HOST=your-rds-endpoint.us-east-1.rds.amazonaws.com
RDS_USER=admin
RDS_PASSWORD=your-secure-password
RDS_DATABASE=bm_calculator
RDS_PORT=3306

# Anthropic API Key (for Claude image analysis)
ANTHROPIC_API_KEY=sk-ant-...
```

## Frontend (.env.production - commit to repo)

```bash
# Backend API URL
VITE_API_URL=https://api.yourdomain.com
# or for EC2:
# VITE_API_URL=http://ec2-54-224-32-168.compute-1.amazonaws.com:3001

# Cognito redirect after login (change for production)
VITE_COGNITO_REDIRECT_URI=https://youramplifyapp.amplifyapp.com

# Supabase (deprecated, keep empty)
# VITE_SUPABASE_URL=...
# VITE_SUPABASE_PUBLISHABLE_DEFAULT_KEY=...
```

## Setup Instructions

1. **On your EC2 instance:**
   ```bash
   cd /path/to/backend
   # Create .env file with RDS and API credentials
   nano .env
   # Add the variables above and save
   ```

2. **For Amplify deployment:**
   - Go to Amplify Console → App settings → Environment variables
   - Add `VITE_API_URL` pointing to your backend
   - Add `VITE_COGNITO_REDIRECT_URI` with your Amplify domain

3. **For local development:**
   - Create `.env.local` (git-ignored) with local values:
   ```bash
   VITE_API_URL=http://localhost:3001
   VITE_COGNITO_REDIRECT_URI=http://localhost:5173
   ```

## Quick Reference: What Changes Where

| Variable | File | Purpose | Example |
|----------|------|---------|---------|
| `RDS_HOST` | Backend `.env` | Database endpoint | `db.us-east-1.rds.amazonaws.com` |
| `RDS_PASSWORD` | Backend `.env` | Database auth | `SecurePassword123!` |
| `ANTHROPIC_API_KEY` | Backend `.env` | Claude API key | `sk-ant-...` |
| `VITE_API_URL` | Frontend `.env.production` | Backend URL | `https://api.yourdomain.com` |
| `VITE_COGNITO_REDIRECT_URI` | Frontend `.env.production` | Auth callback | `https://app.amplifyapp.com` |
| CORS origins | `config.js` | Backend whitelist | See `CORS_ORIGINS` |
| Cognito config | `config.js` + `src/main.jsx` | Auth settings | See `COGNITO` object |
